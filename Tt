USE netsparker;
SELECT C.name, C.email,
       (SELECT D.name 
        FROM Roles D
        JOIN UserRolewebsiteGroupMappings E ON D.Id = E.RoleID 
        WHERE C.Id = E.UserId 
        LIMIT 1) AS Role,
       B.Name, B.value, B.CreatedAt
INTO OUTFILE '/var/lib/mysql-files/user_data.csv'
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM Useractions A
JOIN Useractionparameters B ON A.Id = B.userAction_Id
JOIN users C ON A.userId = C.Id;
